{% load static %}

<html lang="en">

<head>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'favicon/apple-touch-icon.png' %}">
    <link rel="icon" type="image/png" sizes="32x32" href="{% static 'favicon/favicon-32x32.png' %}">
    <link rel="icon" type="image/png" sizes="16x16" href="{% static 'favicon/favicon-16x16.png' %}">
    <link rel="manifest" href="{% static 'favicon/site.webmanifest' %}">


    <!-- Title -->
    <title>{% block title %}Meteo Forecast site{% endblock %}</title>
</head>

<body>
    {% include 'utilities/navbar.html' %}

    <main class="container mt-4">
        {% block content %}{% endblock %}
    </main>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        crossorigin="anonymous"></script>
    <script>
        $(document).ready(function() {
            $('#id_city').on('input', function() {
                var search_term = $(this).val();
                if (search_term.length > 1) {
                    $.get('{% url "weather:autocomplete_city" %}', {term: search_term}, function(data) {
                        var html = '';
                        for (var i = 0; i < data.length; i++) {
                            html += '<div class="autocomplete-item">' + data[i] + '</div>';
                        }
                        $('#autocomplete-list').html(html);
                        $('#autocomplete-list').show();
                    });
                } else {
                    $('#autocomplete-list').html('');
                    $('#autocomplete-list').hide();
                }
            });
    
            $(document).on('click', '.autocomplete-item', function() {
                $('#id_city').val($(this).text());
                $('#autocomplete-list').html('');
                $('#autocomplete-list').hide();
            });
    
            $(document).on('click', function(event) {
                if (!$(event.target).closest('#id_city, #autocomplete-list').length) {
                    $('#autocomplete-list').html('');
                    $('#autocomplete-list').hide();
                }
            });
        });
    </script>
</body>

</html>